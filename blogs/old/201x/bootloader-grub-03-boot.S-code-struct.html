<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="zh-CN" xml:lang="zh-CN">
<head>
<meta charset="utf-8" />
<title>深入理解 GNU GRUB - 02 boot.S MBR结构与boot.S代码结构</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="yanyg" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" href="/themes/blogs/css/blog.css" />
<script type="text/javascript" src="/themes/blogs/js/blog.js"> </script>
</head>
<body>
<div id="preamble" class="status">
<a href="../../../index.html">Yanyg - Software Engineer</a>
<div class="sitelinks">
  <a href="../../archives.html">Archives</a> |
  <a href="../../theindex.html">Index</a> |
  <a href="../../tags.html">TAGS</a> |
  <a href="https://github.com/yygcode">Github</a> |
  <a href="../../../about.html">About Me</a>
</div>
</div>
<div id="content">
<h1 class="title">深入理解 GNU GRUB - 02 boot.S MBR结构与boot.S代码结构</h1>
<div id="table-of-contents">
<h2>&#30446;&#24405;</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgb6187c5">1. MBR结构</a></li>
<li><a href="#orgd80b135">2. boot.S代码结构</a></li>
</ul>
</div>
</div>

<div id="outline-container-orgb6187c5" class="outline-2">
<h2 id="orgb6187c5"><span class="section-number-2">1</span> MBR结构</h2>
<div class="outline-text-2" id="text-1">
<p>
历史悠久的MBR结构自从IBM兼容PC出现以来一直就没变过（但是为支持2TiB以上硬盘而出现的GUID/EFI结构将更改MBR结构）。MBR结构分为三部分，分别是引导指令、分区表
DPT (Disk Partition Table)、幻数Magic (Magic=0x55AA)。其中引导指令占用446字节（0~0x1BD），DPT占用64字节（0x1BE~0x1FD），Magic占用2字节。
</p>

<p>
Magic值总是等于0x55AA，用来标记MBR的有效性。大多数BIOS检测Magic值判断是否为可引导设备，但是也有些BIOS使用另外的字段检测。在所有的小端设备上（例如80x86机器），在写入时需要设置为0xAA55。
</p>

<p>
DPT是硬盘分区表（Disk Partition Table）的缩写。MBR支持4个基本分区项，每个分区项占用16字节。可以将其中一个基本分区项标记为扩展分区（逻辑分区），扩展分区的第一个扇区称为EBR (Extended Boot Record) ，和MBR有类似的结构，但是只能利用两个基本分区项，其中一个用来划分分区，另一个指向新的EBR，这样就可以实现更多的分区。每个分区项的布局完全一致，如下：
</p>
<div class="org-src-container">
<pre class="src src-text">&#20559;&#31227;&#37327;<span class="org-whitespace-space">        </span>&#23383;&#33410;&#25968;<span class="org-whitespace-space">        </span>&#25551;&#36848;
0x00<span class="org-whitespace-space">        </span>1<span class="org-whitespace-space">        </span>&#20998;&#21306;&#29366;&#24577;&#65292;
0x80&#20026;&#21487;&#24341;&#23548;&#20998;&#21306;
0x00&#20026;&#19981;&#21487;&#24341;&#23548;&#20998;&#21306;
&#20854;&#20182;&#20540;&#26080;&#25928;
0x01<span class="org-whitespace-space">        </span>3<span class="org-whitespace-space">        </span>&#35813;&#20998;&#21306;&#31532;&#19968;&#20010;&#25159;&#21306;CHS&#22320;&#22336;&#65292;&#26684;&#24335;&#35265;&#31245;&#21518;&#25551;&#36848;
0x04<span class="org-whitespace-space">        </span>1<span class="org-whitespace-space">        </span>&#20998;&#21306;&#25991;&#20214;&#31995;&#32479;&#26684;&#24335;&#65292;&#27604;&#22914;NTFS/FAT32/Linux&#31561;
0x05<span class="org-whitespace-space">        </span>3<span class="org-whitespace-space">        </span>&#35813;&#20998;&#21306;&#26368;&#21518;&#19968;&#20010;&#25159;&#21306;CHS&#22320;&#22336;&#65292;&#26684;&#24335;&#35265;&#31245;&#21518;&#25551;&#36848;
0x08<span class="org-whitespace-space">        </span>4<span class="org-whitespace-space">        </span>&#35813;&#20998;&#21306;&#31532;&#19968;&#20010;&#25159;&#21306;&#30340;&#32477;&#23545;LBA&#22320;&#22336;
<span class="org-whitespace-space">                          </span>&#34920;&#31034;&#20174;&#30913;&#30424;&#24320;&#22987;&#21040;&#35813;&#20998;&#21306;&#30340;&#25159;&#21306;&#25968;
0x0C<span class="org-whitespace-space">        </span>4<span class="org-whitespace-space">        </span>&#35813;&#20998;&#21306;&#30340;&#25159;&#21306;&#25968;&#37327;

3&#23383;&#33410;&#30340;CHS&#22320;&#22336;&#32467;&#26500;&#22914;&#19979;&#65306;
&#20559;&#31227;&#37327;<span class="org-whitespace-space">            </span>&#25551;&#36848;
0x00<span class="org-whitespace-space">            </span>&#30913;&#22836;
0x01<span class="org-whitespace-space">            </span>&#20302;6&#20301;&#34920;&#31034;&#25159;&#21306;&#65292;&#39640;2&#20301;&#34920;&#31034;&#26609;&#38754;&#30340;9~10&#20301;
0x04<span class="org-whitespace-space">            </span>&#26609;&#38754;&#30340;&#20302;8&#20301;
</pre>
</div>

<p>
对于CHS结构还有疑问者，查阅2.1.4的CHS模式读可加强理解。因为CHS寻址有7.88GiB
限制，现在的硬盘一般都是用LBA寻址，因此分区表中有用的字段是状态字段（0x00）、分区格式（0x03）、扇区偏移量（0x08~0x0B）和扇区数量（0x0C~0x0x0F）。我在虚拟机上测试过，清零硬盘分区的起始CHS地址和结束CHS地址不会导致错误。
446字节的引导指令负责加载另外的磁盘数据，进而引导整个系统。而这也正是boot.S所完成的功能。1.3节的内容大概介绍了加载磁盘数据的过程，而后文的boot.S代码结构分析和详细注释展示具体的实现过程。
</p>
</div>
</div>

<div id="outline-container-orgd80b135" class="outline-2">
<h2 id="orgd80b135"><span class="section-number-2">2</span> boot.S代码结构</h2>
<div class="outline-text-2" id="text-2">
<p>
boot.S生成512字节的机器码，其中0x0~0x1BD (0~445) 共446字节是磁盘（硬盘/软盘）均可能用到的指令；0x1BE~0x1FD (446~510) 共64字节指令是软盘读取需要的指令，完成软盘驱动器复位、读取；0x1F~0x1FF (511~512) 是标识字段为0x 55AA（小端上需要表述为0xAA55）。
</p>

<p>
GRUB安装程序判断存储媒介是硬盘或软盘。如果是硬盘，写入0x0~0x1BD和0x1FE~0x1FF两个字段。如果是软盘则写入整个MBR（512字节）。下面先简单介绍代码对指令位置的安排，其中0x7C**是指MBR加载到内存后对应指令所在的内存地址。
</p>

<p>
boot.S首先是一个跳转指令和一个空指令，占用3字节空间（0x7C00~0x7C03）。
</p>

<p>
之后保留一字节空间（0x7C04），后续代码保存BIOS调用探测到的读模式（LBA/CHS）到这里。执行到GRUB的第二步时还会使用这里保存的读模式标记。
</p>

<p>
之后是BIOS参数块BPB (BIOS parameter block)所在空间，共保留0x56（0x7C04~0x7C59）字节，当前只用到开始的16字节。BPB首字节（0x7C04）用来保存BIOS调用探测到的读模式（LBA/CHS），执行到GRUB的第二步时还会使用这里保存的读模式标记。
</p>

<p>
接下来的16字节（0x7C05~0x7C14）用作BIOS LBA读调用的DAP（参见2.1.2），这16个字节是和CHS参数块是复用的，如果是CHS，则用作保存BIOS调用获取的驱动器CHS参数，后来的CHS读扇区用它判定扇区是否越界。
</p>

<p>
之后是2字节的跳转指令（0x7C5A~0x7C5B），加载完毕后跳向此处执行，因为jmp不支持立即数，因此保存在这里，值为0x8000。
</p>

<p>
之后是8字节的GRUB内核起始扇区LBA地址（0x7C5C~0x7C63），注意顺序，首先是低4字节，然后是高4字节。默认值为低4字节0x01，高4字节0x00，即磁盘的第二个绝对扇区。
</p>

<p>
之后是一字节的驱动器（0x7C64），默认设置为0xFF，安装时候改写成正确的引导驱动器，如果代码中探测到依然是0xFF，则会赋默认驱动器0x80（第一块硬盘编号）。
</p>

<p>
之后关闭中断，检测磁盘驱动器，设置寄存器，设置堆栈，打开中断，使用BIOS例程判断读取模式，读取磁盘数据，保存读取模式（保存到mode即0x7C04位置），最后设置正确的寄存器，然后跳转到第二步执行。
</p>

<p>
0x1BE~0x1FD是只针对软盘读取的指令。这些指令不会安装到硬盘MBR（硬盘上这里是DPT区域，写入
DPT会破坏分区）。0x1FE~0x1FF保存标识数0xAA55（0x1FE值为0x55，0x1FF值为0xAA，注意0xAA55
是针对小端序处理器的）。下面是编译（未安装）的grub-1.98/boot.S的二进制码：
</p>
<div class="org-src-container">
<pre class="src src-text">0X7C00<span class="org-whitespace-space"> </span>EB<span class="org-whitespace-space"> </span>63<span class="org-whitespace-space"> </span>90<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00
0X7C10<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00
0X7C20<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00
0X7C30<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00
0X7C40<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00
0X7C50<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>80<span class="org-whitespace-space"> </span>01<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00
0X7C60<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>FF<span class="org-whitespace-space"> </span>FA<span class="org-whitespace-space"> </span>EB<span class="org-whitespace-space"> </span>07<span class="org-whitespace-space"> </span>F6<span class="org-whitespace-space"> </span>C2<span class="org-whitespace-space"> </span>80<span class="org-whitespace-space"> </span>75<span class="org-whitespace-space"> </span>02<span class="org-whitespace-space"> </span>B2<span class="org-whitespace-space"> </span>80<span class="org-whitespace-space"> </span>EA
0X7C70<span class="org-whitespace-space"> </span>74<span class="org-whitespace-space"> </span>7C<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>31<span class="org-whitespace-space"> </span>C0<span class="org-whitespace-space"> </span>8E<span class="org-whitespace-space"> </span>D8<span class="org-whitespace-space"> </span>8E<span class="org-whitespace-space"> </span>D0<span class="org-whitespace-space"> </span>BC<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>20<span class="org-whitespace-space"> </span>FB<span class="org-whitespace-space"> </span>A0<span class="org-whitespace-space"> </span>64
0X7C80<span class="org-whitespace-space"> </span>7C<span class="org-whitespace-space"> </span>3C<span class="org-whitespace-space"> </span>FF<span class="org-whitespace-space"> </span>74<span class="org-whitespace-space"> </span>02<span class="org-whitespace-space"> </span>88<span class="org-whitespace-space"> </span>C2<span class="org-whitespace-space"> </span>52<span class="org-whitespace-space"> </span>BE<span class="org-whitespace-space"> </span>88<span class="org-whitespace-space"> </span>7D<span class="org-whitespace-space"> </span>E8<span class="org-whitespace-space"> </span>24<span class="org-whitespace-space"> </span>01<span class="org-whitespace-space"> </span>BE<span class="org-whitespace-space"> </span>05
0X7C90<span class="org-whitespace-space"> </span>7C<span class="org-whitespace-space"> </span>F6<span class="org-whitespace-space"> </span>C2<span class="org-whitespace-space"> </span>80<span class="org-whitespace-space"> </span>74<span class="org-whitespace-space"> </span>48<span class="org-whitespace-space"> </span>B4<span class="org-whitespace-space"> </span>41<span class="org-whitespace-space"> </span>BB<span class="org-whitespace-space"> </span>AA<span class="org-whitespace-space"> </span>55<span class="org-whitespace-space"> </span>CD<span class="org-whitespace-space"> </span>13<span class="org-whitespace-space"> </span>5A<span class="org-whitespace-space"> </span>52<span class="org-whitespace-space"> </span>72
0X7CA0<span class="org-whitespace-space"> </span>3D<span class="org-whitespace-space"> </span>81<span class="org-whitespace-space"> </span>FB<span class="org-whitespace-space"> </span>55<span class="org-whitespace-space"> </span>AA<span class="org-whitespace-space"> </span>75<span class="org-whitespace-space"> </span>37<span class="org-whitespace-space"> </span>83<span class="org-whitespace-space"> </span>E1<span class="org-whitespace-space"> </span>01<span class="org-whitespace-space"> </span>74<span class="org-whitespace-space"> </span>32<span class="org-whitespace-space"> </span>31<span class="org-whitespace-space"> </span>C0<span class="org-whitespace-space"> </span>89<span class="org-whitespace-space"> </span>44
0X7CB0<span class="org-whitespace-space"> </span>04<span class="org-whitespace-space"> </span>40<span class="org-whitespace-space"> </span>88<span class="org-whitespace-space"> </span>44<span class="org-whitespace-space"> </span>FF<span class="org-whitespace-space"> </span>89<span class="org-whitespace-space"> </span>44<span class="org-whitespace-space"> </span>02<span class="org-whitespace-space"> </span>C7<span class="org-whitespace-space"> </span>04<span class="org-whitespace-space"> </span>10<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>66<span class="org-whitespace-space"> </span>8B<span class="org-whitespace-space"> </span>1E<span class="org-whitespace-space"> </span>5C
0X7CC0<span class="org-whitespace-space"> </span>7C<span class="org-whitespace-space"> </span>66<span class="org-whitespace-space"> </span>89<span class="org-whitespace-space"> </span>5C<span class="org-whitespace-space"> </span>08<span class="org-whitespace-space"> </span>66<span class="org-whitespace-space"> </span>8B<span class="org-whitespace-space"> </span>1E<span class="org-whitespace-space"> </span>60<span class="org-whitespace-space"> </span>7C<span class="org-whitespace-space"> </span>66<span class="org-whitespace-space"> </span>89<span class="org-whitespace-space"> </span>5C<span class="org-whitespace-space"> </span>0C<span class="org-whitespace-space"> </span>C7<span class="org-whitespace-space"> </span>44
0X7CD0<span class="org-whitespace-space"> </span>06<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>70<span class="org-whitespace-space"> </span>B4<span class="org-whitespace-space"> </span>42<span class="org-whitespace-space"> </span>CD<span class="org-whitespace-space"> </span>13<span class="org-whitespace-space"> </span>72<span class="org-whitespace-space"> </span>05<span class="org-whitespace-space"> </span>BB<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>70<span class="org-whitespace-space"> </span>EB<span class="org-whitespace-space"> </span>73<span class="org-whitespace-space"> </span>B4<span class="org-whitespace-space"> </span>08
0X7CE0<span class="org-whitespace-space"> </span>CD<span class="org-whitespace-space"> </span>13<span class="org-whitespace-space"> </span>73<span class="org-whitespace-space"> </span>0A<span class="org-whitespace-space"> </span>F6<span class="org-whitespace-space"> </span>C2<span class="org-whitespace-space"> </span>80<span class="org-whitespace-space"> </span>0F<span class="org-whitespace-space"> </span>84<span class="org-whitespace-space"> </span>D8<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>E9<span class="org-whitespace-space"> </span>82<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>66<span class="org-whitespace-space"> </span>0F
0X7CF0<span class="org-whitespace-space"> </span>B6<span class="org-whitespace-space"> </span>C6<span class="org-whitespace-space"> </span>88<span class="org-whitespace-space"> </span>64<span class="org-whitespace-space"> </span>FF<span class="org-whitespace-space"> </span>40<span class="org-whitespace-space"> </span>66<span class="org-whitespace-space"> </span>89<span class="org-whitespace-space"> </span>44<span class="org-whitespace-space"> </span>04<span class="org-whitespace-space"> </span>0F<span class="org-whitespace-space"> </span>B6<span class="org-whitespace-space"> </span>D1<span class="org-whitespace-space"> </span>C1<span class="org-whitespace-space"> </span>E2<span class="org-whitespace-space"> </span>02
0X7D00<span class="org-whitespace-space"> </span>88<span class="org-whitespace-space"> </span>E8<span class="org-whitespace-space"> </span>88<span class="org-whitespace-space"> </span>F4<span class="org-whitespace-space"> </span>40<span class="org-whitespace-space"> </span>89<span class="org-whitespace-space"> </span>44<span class="org-whitespace-space"> </span>08<span class="org-whitespace-space"> </span>0F<span class="org-whitespace-space"> </span>B6<span class="org-whitespace-space"> </span>C2<span class="org-whitespace-space"> </span>C0<span class="org-whitespace-space"> </span>E8<span class="org-whitespace-space"> </span>02<span class="org-whitespace-space"> </span>66<span class="org-whitespace-space"> </span>89
0X7D10<span class="org-whitespace-space"> </span>04<span class="org-whitespace-space"> </span>66<span class="org-whitespace-space"> </span>A1<span class="org-whitespace-space"> </span>60<span class="org-whitespace-space"> </span>7C<span class="org-whitespace-space"> </span>66<span class="org-whitespace-space"> </span>09<span class="org-whitespace-space"> </span>C0<span class="org-whitespace-space"> </span>75<span class="org-whitespace-space"> </span>4E<span class="org-whitespace-space"> </span>66<span class="org-whitespace-space"> </span>A1<span class="org-whitespace-space"> </span>5C<span class="org-whitespace-space"> </span>7C<span class="org-whitespace-space"> </span>66<span class="org-whitespace-space"> </span>31
0X7D20<span class="org-whitespace-space"> </span>D2<span class="org-whitespace-space"> </span>66<span class="org-whitespace-space"> </span>F7<span class="org-whitespace-space"> </span>34<span class="org-whitespace-space"> </span>88<span class="org-whitespace-space"> </span>D1<span class="org-whitespace-space"> </span>31<span class="org-whitespace-space"> </span>D2<span class="org-whitespace-space"> </span>66<span class="org-whitespace-space"> </span>F7<span class="org-whitespace-space"> </span>74<span class="org-whitespace-space"> </span>04<span class="org-whitespace-space"> </span>3B<span class="org-whitespace-space"> </span>44<span class="org-whitespace-space"> </span>08<span class="org-whitespace-space"> </span>7D
0X7D30<span class="org-whitespace-space"> </span>37<span class="org-whitespace-space"> </span>FE<span class="org-whitespace-space"> </span>C1<span class="org-whitespace-space"> </span>88<span class="org-whitespace-space"> </span>C5<span class="org-whitespace-space"> </span>30<span class="org-whitespace-space"> </span>C0<span class="org-whitespace-space"> </span>C1<span class="org-whitespace-space"> </span>E8<span class="org-whitespace-space"> </span>02<span class="org-whitespace-space"> </span>08<span class="org-whitespace-space"> </span>C1<span class="org-whitespace-space"> </span>88<span class="org-whitespace-space"> </span>D0<span class="org-whitespace-space"> </span>5A<span class="org-whitespace-space"> </span>88
0X7D40<span class="org-whitespace-space"> </span>C6<span class="org-whitespace-space"> </span>BB<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>70<span class="org-whitespace-space"> </span>8E<span class="org-whitespace-space"> </span>C3<span class="org-whitespace-space"> </span>31<span class="org-whitespace-space"> </span>DB<span class="org-whitespace-space"> </span>B8<span class="org-whitespace-space"> </span>01<span class="org-whitespace-space"> </span>02<span class="org-whitespace-space"> </span>CD<span class="org-whitespace-space"> </span>13<span class="org-whitespace-space"> </span>72<span class="org-whitespace-space"> </span>29<span class="org-whitespace-space"> </span>8C
0X7D50<span class="org-whitespace-space"> </span>C3<span class="org-whitespace-space"> </span>60<span class="org-whitespace-space"> </span>1E<span class="org-whitespace-space"> </span>B9<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>01<span class="org-whitespace-space"> </span>8E<span class="org-whitespace-space"> </span>DB<span class="org-whitespace-space"> </span>31<span class="org-whitespace-space"> </span>F6<span class="org-whitespace-space"> </span>BF<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>80<span class="org-whitespace-space"> </span>8E<span class="org-whitespace-space"> </span>C6<span class="org-whitespace-space"> </span>FC
0X7D60<span class="org-whitespace-space"> </span>F3<span class="org-whitespace-space"> </span>A5<span class="org-whitespace-space"> </span>1F<span class="org-whitespace-space"> </span>61<span class="org-whitespace-space"> </span>FF<span class="org-whitespace-space"> </span>26<span class="org-whitespace-space"> </span>5A<span class="org-whitespace-space"> </span>7C<span class="org-whitespace-space"> </span>BE<span class="org-whitespace-space"> </span>8E<span class="org-whitespace-space"> </span>7D<span class="org-whitespace-space"> </span>E8<span class="org-whitespace-space"> </span>44<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>EB<span class="org-whitespace-space"> </span>0E
0X7D70<span class="org-whitespace-space"> </span>BE<span class="org-whitespace-space"> </span>93<span class="org-whitespace-space"> </span>7D<span class="org-whitespace-space"> </span>E8<span class="org-whitespace-space"> </span>3C<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>EB<span class="org-whitespace-space"> </span>06<span class="org-whitespace-space"> </span>BE<span class="org-whitespace-space"> </span>9D<span class="org-whitespace-space"> </span>7D<span class="org-whitespace-space"> </span>E8<span class="org-whitespace-space"> </span>34<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>BE<span class="org-whitespace-space"> </span>A2
0X7D80<span class="org-whitespace-space"> </span>7D<span class="org-whitespace-space"> </span>E8<span class="org-whitespace-space"> </span>2E<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>CD<span class="org-whitespace-space"> </span>18<span class="org-whitespace-space"> </span>EB<span class="org-whitespace-space"> </span>FE<span class="org-whitespace-space"> </span>47<span class="org-whitespace-space"> </span>52<span class="org-whitespace-space"> </span>55<span class="org-whitespace-space"> </span>42<span class="org-whitespace-space"> </span>20<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>47<span class="org-whitespace-space"> </span>65
0X7D90<span class="org-whitespace-space"> </span>6F<span class="org-whitespace-space"> </span>6D<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>48<span class="org-whitespace-space"> </span>61<span class="org-whitespace-space"> </span>72<span class="org-whitespace-space"> </span>64<span class="org-whitespace-space"> </span>20<span class="org-whitespace-space"> </span>44<span class="org-whitespace-space"> </span>69<span class="org-whitespace-space"> </span>73<span class="org-whitespace-space"> </span>6B<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>52<span class="org-whitespace-space"> </span>65<span class="org-whitespace-space"> </span>61
0X7DA0<span class="org-whitespace-space"> </span>64<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>20<span class="org-whitespace-space"> </span>45<span class="org-whitespace-space"> </span>72<span class="org-whitespace-space"> </span>72<span class="org-whitespace-space"> </span>6F<span class="org-whitespace-space"> </span>72<span class="org-whitespace-space"> </span>0D<span class="org-whitespace-space"> </span>0A<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>BB<span class="org-whitespace-space"> </span>01<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>B4<span class="org-whitespace-space"> </span>0E
0X7DB0<span class="org-whitespace-space"> </span>CD<span class="org-whitespace-space"> </span>10<span class="org-whitespace-space"> </span>AC<span class="org-whitespace-space"> </span>3C<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>75<span class="org-whitespace-space"> </span>F4<span class="org-whitespace-space"> </span>C3<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>24<span class="org-whitespace-space"> </span>12
0X7DC0<span class="org-whitespace-space"> </span>0F<span class="org-whitespace-space"> </span>09<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>BE<span class="org-whitespace-space"> </span>BD<span class="org-whitespace-space"> </span>7D<span class="org-whitespace-space"> </span>31<span class="org-whitespace-space"> </span>C0<span class="org-whitespace-space"> </span>CD<span class="org-whitespace-space"> </span>13<span class="org-whitespace-space"> </span>46<span class="org-whitespace-space"> </span>8A<span class="org-whitespace-space"> </span>0C<span class="org-whitespace-space"> </span>80<span class="org-whitespace-space"> </span>F9<span class="org-whitespace-space"> </span>00
0X7DD0<span class="org-whitespace-space"> </span>75<span class="org-whitespace-space"> </span>0F<span class="org-whitespace-space"> </span>BE<span class="org-whitespace-space"> </span>DA<span class="org-whitespace-space"> </span>7D<span class="org-whitespace-space"> </span>E8<span class="org-whitespace-space"> </span>DA<span class="org-whitespace-space"> </span>FF<span class="org-whitespace-space"> </span>EB<span class="org-whitespace-space"> </span>A4<span class="org-whitespace-space"> </span>46<span class="org-whitespace-space"> </span>6C<span class="org-whitespace-space"> </span>6F<span class="org-whitespace-space"> </span>70<span class="org-whitespace-space"> </span>70<span class="org-whitespace-space"> </span>79
0X7DE0<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>BB<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>70<span class="org-whitespace-space"> </span>B8<span class="org-whitespace-space"> </span>01<span class="org-whitespace-space"> </span>02<span class="org-whitespace-space"> </span>B5<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>B6<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>CD<span class="org-whitespace-space"> </span>13<span class="org-whitespace-space"> </span>72<span class="org-whitespace-space"> </span>D7<span class="org-whitespace-space"> </span>B6
0X7DF0<span class="org-whitespace-space"> </span>01<span class="org-whitespace-space"> </span>B5<span class="org-whitespace-space"> </span>4F<span class="org-whitespace-space"> </span>E9<span class="org-whitespace-space"> </span>F8<span class="org-whitespace-space"> </span>FE<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>55<span class="org-whitespace-space"> </span>AA
</pre>
</div>

<p>
下面是安装以后的MBR内内容：
</p>
<div class="org-src-container">
<pre class="src src-text">0X7C00<span class="org-whitespace-space"> </span>EB<span class="org-whitespace-space"> </span>63<span class="org-whitespace-space"> </span>90<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00
0X7C10<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00
0X7C20<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00
0X7C30<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00
0X7C40<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00
0X7C50<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>80<span class="org-whitespace-space"> </span>01<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00
0X7C60<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>FF<span class="org-whitespace-space"> </span>FA<span class="org-whitespace-space"> </span>EB<span class="org-whitespace-space"> </span>07<span class="org-whitespace-space"> </span>F6<span class="org-whitespace-space"> </span>C2<span class="org-whitespace-space"> </span>80<span class="org-whitespace-space"> </span>75<span class="org-whitespace-space"> </span>02<span class="org-whitespace-space"> </span>B2<span class="org-whitespace-space"> </span>80<span class="org-whitespace-space"> </span>EA
0X7C70<span class="org-whitespace-space"> </span>74<span class="org-whitespace-space"> </span>7C<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>31<span class="org-whitespace-space"> </span>C0<span class="org-whitespace-space"> </span>8E<span class="org-whitespace-space"> </span>D8<span class="org-whitespace-space"> </span>8E<span class="org-whitespace-space"> </span>D0<span class="org-whitespace-space"> </span>BC<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>20<span class="org-whitespace-space"> </span>FB<span class="org-whitespace-space"> </span>A0<span class="org-whitespace-space"> </span>64
0X7C80<span class="org-whitespace-space"> </span>7C<span class="org-whitespace-space"> </span>3C<span class="org-whitespace-space"> </span>FF<span class="org-whitespace-space"> </span>74<span class="org-whitespace-space"> </span>02<span class="org-whitespace-space"> </span>88<span class="org-whitespace-space"> </span>C2<span class="org-whitespace-space"> </span>52<span class="org-whitespace-space"> </span>BE<span class="org-whitespace-space"> </span>88<span class="org-whitespace-space"> </span>7D<span class="org-whitespace-space"> </span>E8<span class="org-whitespace-space"> </span>24<span class="org-whitespace-space"> </span>01<span class="org-whitespace-space"> </span>BE<span class="org-whitespace-space"> </span>05
0X7C90<span class="org-whitespace-space"> </span>7C<span class="org-whitespace-space"> </span>F6<span class="org-whitespace-space"> </span>C2<span class="org-whitespace-space"> </span>80<span class="org-whitespace-space"> </span>74<span class="org-whitespace-space"> </span>48<span class="org-whitespace-space"> </span>B4<span class="org-whitespace-space"> </span>41<span class="org-whitespace-space"> </span>BB<span class="org-whitespace-space"> </span>AA<span class="org-whitespace-space"> </span>55<span class="org-whitespace-space"> </span>CD<span class="org-whitespace-space"> </span>13<span class="org-whitespace-space"> </span>5A<span class="org-whitespace-space"> </span>52<span class="org-whitespace-space"> </span>72
0X7CA0<span class="org-whitespace-space"> </span>3D<span class="org-whitespace-space"> </span>81<span class="org-whitespace-space"> </span>FB<span class="org-whitespace-space"> </span>55<span class="org-whitespace-space"> </span>AA<span class="org-whitespace-space"> </span>75<span class="org-whitespace-space"> </span>37<span class="org-whitespace-space"> </span>83<span class="org-whitespace-space"> </span>E1<span class="org-whitespace-space"> </span>01<span class="org-whitespace-space"> </span>74<span class="org-whitespace-space"> </span>32<span class="org-whitespace-space"> </span>31<span class="org-whitespace-space"> </span>C0<span class="org-whitespace-space"> </span>89<span class="org-whitespace-space"> </span>44
0X7CB0<span class="org-whitespace-space"> </span>04<span class="org-whitespace-space"> </span>40<span class="org-whitespace-space"> </span>88<span class="org-whitespace-space"> </span>44<span class="org-whitespace-space"> </span>FF<span class="org-whitespace-space"> </span>89<span class="org-whitespace-space"> </span>44<span class="org-whitespace-space"> </span>02<span class="org-whitespace-space"> </span>C7<span class="org-whitespace-space"> </span>04<span class="org-whitespace-space"> </span>10<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>66<span class="org-whitespace-space"> </span>8B<span class="org-whitespace-space"> </span>1E<span class="org-whitespace-space"> </span>5C
0X7CC0<span class="org-whitespace-space"> </span>7C<span class="org-whitespace-space"> </span>66<span class="org-whitespace-space"> </span>89<span class="org-whitespace-space"> </span>5C<span class="org-whitespace-space"> </span>08<span class="org-whitespace-space"> </span>66<span class="org-whitespace-space"> </span>8B<span class="org-whitespace-space"> </span>1E<span class="org-whitespace-space"> </span>60<span class="org-whitespace-space"> </span>7C<span class="org-whitespace-space"> </span>66<span class="org-whitespace-space"> </span>89<span class="org-whitespace-space"> </span>5C<span class="org-whitespace-space"> </span>0C<span class="org-whitespace-space"> </span>C7<span class="org-whitespace-space"> </span>44
0X7CD0<span class="org-whitespace-space"> </span>06<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>70<span class="org-whitespace-space"> </span>B4<span class="org-whitespace-space"> </span>42<span class="org-whitespace-space"> </span>CD<span class="org-whitespace-space"> </span>13<span class="org-whitespace-space"> </span>72<span class="org-whitespace-space"> </span>05<span class="org-whitespace-space"> </span>BB<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>70<span class="org-whitespace-space"> </span>EB<span class="org-whitespace-space"> </span>73<span class="org-whitespace-space"> </span>B4<span class="org-whitespace-space"> </span>08
0X7CE0<span class="org-whitespace-space"> </span>CD<span class="org-whitespace-space"> </span>13<span class="org-whitespace-space"> </span>73<span class="org-whitespace-space"> </span>0A<span class="org-whitespace-space"> </span>F6<span class="org-whitespace-space"> </span>C2<span class="org-whitespace-space"> </span>80<span class="org-whitespace-space"> </span>0F<span class="org-whitespace-space"> </span>84<span class="org-whitespace-space"> </span>D8<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>E9<span class="org-whitespace-space"> </span>82<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>66<span class="org-whitespace-space"> </span>0F
0X7CF0<span class="org-whitespace-space"> </span>B6<span class="org-whitespace-space"> </span>C6<span class="org-whitespace-space"> </span>88<span class="org-whitespace-space"> </span>64<span class="org-whitespace-space"> </span>FF<span class="org-whitespace-space"> </span>40<span class="org-whitespace-space"> </span>66<span class="org-whitespace-space"> </span>89<span class="org-whitespace-space"> </span>44<span class="org-whitespace-space"> </span>04<span class="org-whitespace-space"> </span>0F<span class="org-whitespace-space"> </span>B6<span class="org-whitespace-space"> </span>D1<span class="org-whitespace-space"> </span>C1<span class="org-whitespace-space"> </span>E2<span class="org-whitespace-space"> </span>02
0X7D00<span class="org-whitespace-space"> </span>88<span class="org-whitespace-space"> </span>E8<span class="org-whitespace-space"> </span>88<span class="org-whitespace-space"> </span>F4<span class="org-whitespace-space"> </span>40<span class="org-whitespace-space"> </span>89<span class="org-whitespace-space"> </span>44<span class="org-whitespace-space"> </span>08<span class="org-whitespace-space"> </span>0F<span class="org-whitespace-space"> </span>B6<span class="org-whitespace-space"> </span>C2<span class="org-whitespace-space"> </span>C0<span class="org-whitespace-space"> </span>E8<span class="org-whitespace-space"> </span>02<span class="org-whitespace-space"> </span>66<span class="org-whitespace-space"> </span>89
0X7D10<span class="org-whitespace-space"> </span>04<span class="org-whitespace-space"> </span>66<span class="org-whitespace-space"> </span>A1<span class="org-whitespace-space"> </span>60<span class="org-whitespace-space"> </span>7C<span class="org-whitespace-space"> </span>66<span class="org-whitespace-space"> </span>09<span class="org-whitespace-space"> </span>C0<span class="org-whitespace-space"> </span>75<span class="org-whitespace-space"> </span>4E<span class="org-whitespace-space"> </span>66<span class="org-whitespace-space"> </span>A1<span class="org-whitespace-space"> </span>5C<span class="org-whitespace-space"> </span>7C<span class="org-whitespace-space"> </span>66<span class="org-whitespace-space"> </span>31
0X7D20<span class="org-whitespace-space"> </span>D2<span class="org-whitespace-space"> </span>66<span class="org-whitespace-space"> </span>F7<span class="org-whitespace-space"> </span>34<span class="org-whitespace-space"> </span>88<span class="org-whitespace-space"> </span>D1<span class="org-whitespace-space"> </span>31<span class="org-whitespace-space"> </span>D2<span class="org-whitespace-space"> </span>66<span class="org-whitespace-space"> </span>F7<span class="org-whitespace-space"> </span>74<span class="org-whitespace-space"> </span>04<span class="org-whitespace-space"> </span>3B<span class="org-whitespace-space"> </span>44<span class="org-whitespace-space"> </span>08<span class="org-whitespace-space"> </span>7D
0X7D30<span class="org-whitespace-space"> </span>37<span class="org-whitespace-space"> </span>FE<span class="org-whitespace-space"> </span>C1<span class="org-whitespace-space"> </span>88<span class="org-whitespace-space"> </span>C5<span class="org-whitespace-space"> </span>30<span class="org-whitespace-space"> </span>C0<span class="org-whitespace-space"> </span>C1<span class="org-whitespace-space"> </span>E8<span class="org-whitespace-space"> </span>02<span class="org-whitespace-space"> </span>08<span class="org-whitespace-space"> </span>C1<span class="org-whitespace-space"> </span>88<span class="org-whitespace-space"> </span>D0<span class="org-whitespace-space"> </span>5A<span class="org-whitespace-space"> </span>88
0X7D40<span class="org-whitespace-space"> </span>C6<span class="org-whitespace-space"> </span>BB<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>70<span class="org-whitespace-space"> </span>8E<span class="org-whitespace-space"> </span>C3<span class="org-whitespace-space"> </span>31<span class="org-whitespace-space"> </span>DB<span class="org-whitespace-space"> </span>B8<span class="org-whitespace-space"> </span>01<span class="org-whitespace-space"> </span>02<span class="org-whitespace-space"> </span>CD<span class="org-whitespace-space"> </span>13<span class="org-whitespace-space"> </span>72<span class="org-whitespace-space"> </span>29<span class="org-whitespace-space"> </span>8C
0X7D50<span class="org-whitespace-space"> </span>C3<span class="org-whitespace-space"> </span>60<span class="org-whitespace-space"> </span>1E<span class="org-whitespace-space"> </span>B9<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>01<span class="org-whitespace-space"> </span>8E<span class="org-whitespace-space"> </span>DB<span class="org-whitespace-space"> </span>31<span class="org-whitespace-space"> </span>F6<span class="org-whitespace-space"> </span>BF<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>80<span class="org-whitespace-space"> </span>8E<span class="org-whitespace-space"> </span>C6<span class="org-whitespace-space"> </span>FC
0X7D60<span class="org-whitespace-space"> </span>F3<span class="org-whitespace-space"> </span>A5<span class="org-whitespace-space"> </span>1F<span class="org-whitespace-space"> </span>61<span class="org-whitespace-space"> </span>FF<span class="org-whitespace-space"> </span>26<span class="org-whitespace-space"> </span>5A<span class="org-whitespace-space"> </span>7C<span class="org-whitespace-space"> </span>BE<span class="org-whitespace-space"> </span>8E<span class="org-whitespace-space"> </span>7D<span class="org-whitespace-space"> </span>E8<span class="org-whitespace-space"> </span>44<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>EB<span class="org-whitespace-space"> </span>0E
0X7D70<span class="org-whitespace-space"> </span>BE<span class="org-whitespace-space"> </span>93<span class="org-whitespace-space"> </span>7D<span class="org-whitespace-space"> </span>E8<span class="org-whitespace-space"> </span>3C<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>EB<span class="org-whitespace-space"> </span>06<span class="org-whitespace-space"> </span>BE<span class="org-whitespace-space"> </span>9D<span class="org-whitespace-space"> </span>7D<span class="org-whitespace-space"> </span>E8<span class="org-whitespace-space"> </span>34<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>BE<span class="org-whitespace-space"> </span>A2
0X7D80<span class="org-whitespace-space"> </span>7D<span class="org-whitespace-space"> </span>E8<span class="org-whitespace-space"> </span>2E<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>CD<span class="org-whitespace-space"> </span>18<span class="org-whitespace-space"> </span>EB<span class="org-whitespace-space"> </span>FE<span class="org-whitespace-space"> </span>47<span class="org-whitespace-space"> </span>52<span class="org-whitespace-space"> </span>55<span class="org-whitespace-space"> </span>42<span class="org-whitespace-space"> </span>20<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>47<span class="org-whitespace-space"> </span>65
0X7D90<span class="org-whitespace-space"> </span>6F<span class="org-whitespace-space"> </span>6D<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>48<span class="org-whitespace-space"> </span>61<span class="org-whitespace-space"> </span>72<span class="org-whitespace-space"> </span>64<span class="org-whitespace-space"> </span>20<span class="org-whitespace-space"> </span>44<span class="org-whitespace-space"> </span>69<span class="org-whitespace-space"> </span>73<span class="org-whitespace-space"> </span>6B<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>52<span class="org-whitespace-space"> </span>65<span class="org-whitespace-space"> </span>61
0X7DA0<span class="org-whitespace-space"> </span>64<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>20<span class="org-whitespace-space"> </span>45<span class="org-whitespace-space"> </span>72<span class="org-whitespace-space"> </span>72<span class="org-whitespace-space"> </span>6F<span class="org-whitespace-space"> </span>72<span class="org-whitespace-space"> </span>0D<span class="org-whitespace-space"> </span>0A<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>BB<span class="org-whitespace-space"> </span>01<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>B4<span class="org-whitespace-space"> </span>0E
0X7DB0<span class="org-whitespace-space"> </span>CD<span class="org-whitespace-space"> </span>10<span class="org-whitespace-space"> </span>AC<span class="org-whitespace-space"> </span>3C<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>75<span class="org-whitespace-space"> </span>F4<span class="org-whitespace-space"> </span>C3<span class="org-whitespace-space"> </span>55<span class="org-whitespace-space"> </span>6D<span class="org-whitespace-space"> </span>01<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>80<span class="org-whitespace-space"> </span>20
0X7DC0<span class="org-whitespace-space"> </span>21<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>83<span class="org-whitespace-space"> </span>B2<span class="org-whitespace-space"> </span>02<span class="org-whitespace-space"> </span>30<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>08<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>E8<span class="org-whitespace-space"> </span>0B<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>D2
0X7DD0<span class="org-whitespace-space"> </span>21<span class="org-whitespace-space"> </span>30<span class="org-whitespace-space"> </span>05<span class="org-whitespace-space"> </span>FE<span class="org-whitespace-space"> </span>FF<span class="org-whitespace-space"> </span>FF<span class="org-whitespace-space"> </span>FE<span class="org-whitespace-space"> </span>F7<span class="org-whitespace-space"> </span>0B<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>02<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>F4<span class="org-whitespace-space"> </span>01<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00
0X7DE0<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00
0X7DF0<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>00<span class="org-whitespace-space"> </span>55<span class="org-whitespace-space"> </span>AA
</pre>
</div>

<p>
对照可以看出，DPT部分是有差异的，这是因为boot.S编译后的指令码中这部分是软盘复位和读指令，而硬盘MBR中保存DPT。正如同前文所述，我尝试把DPT中CHS地址相关的部分给置
0后，测试GRUB仍然正常工作（偏移量是）。
</p>

<p>
另外一个差异是0x7DB8~0x7DBE空间的6个字节，boot.S注释说是为了兼容Windows NT，因为
Windows NT在这里插入了一个幻数，我尝试把这6个字节（偏移量0x1B8~0x1BD）置0，经测试
GRUB是可以正常工作的。
</p>

<p>
8字节的GRUB内核安装扇区也一样，是因为我的虚拟机的GRUB内核确实安装在第二个扇区，如果是和Windows共存的双系统安装，这8字节可能会有所差异（需要指向实际的安装扇区）。
MBR中Windows NT幻数和DPT中CHS地址部分清的指令如下：
</p>
<div class="org-src-container">
<pre class="src src-sh">~#<span class="org-whitespace-space"> </span>dd<span class="org-whitespace-space"> </span><span class="org-variable-name">if</span>=/dev/zero<span class="org-whitespace-space"> </span><span class="org-variable-name">of</span>=/dev/sda<span class="org-whitespace-space"> </span><span class="org-variable-name">seek</span>=440<span class="org-whitespace-space"> </span><span class="org-variable-name">count</span>=6<span class="org-whitespace-space"> </span><span class="org-variable-name">bs</span>=1
~#<span class="org-whitespace-space"> </span>dd<span class="org-whitespace-space"> </span><span class="org-variable-name">if</span>=/dev/zero<span class="org-whitespace-space"> </span><span class="org-variable-name">of</span>=/dev/sda<span class="org-whitespace-space"> </span><span class="org-variable-name">seek</span>=447<span class="org-whitespace-space"> </span><span class="org-variable-name">count</span>=3<span class="org-whitespace-space"> </span><span class="org-variable-name">bs</span>=1
~#<span class="org-whitespace-space"> </span>dd<span class="org-whitespace-space"> </span><span class="org-variable-name">if</span>=/dev/zero<span class="org-whitespace-space"> </span><span class="org-variable-name">of</span>=/dev/sda<span class="org-whitespace-space"> </span><span class="org-variable-name">seek</span>=463<span class="org-whitespace-space"> </span><span class="org-variable-name">count</span>=3<span class="org-whitespace-space"> </span><span class="org-variable-name">bs</span>=1
~#<span class="org-whitespace-space"> </span>dd<span class="org-whitespace-space"> </span><span class="org-variable-name">if</span>=/dev/zero<span class="org-whitespace-space"> </span><span class="org-variable-name">of</span>=/dev/sda<span class="org-whitespace-space"> </span><span class="org-variable-name">seek</span>=451<span class="org-whitespace-space"> </span><span class="org-variable-name">count</span>=3<span class="org-whitespace-space"> </span><span class="org-variable-name">bs</span>=1
~#<span class="org-whitespace-space"> </span>dd<span class="org-whitespace-space"> </span><span class="org-variable-name">if</span>=/dev/zero<span class="org-whitespace-space"> </span><span class="org-variable-name">of</span>=/dev/sda<span class="org-whitespace-space"> </span><span class="org-variable-name">seek</span>=467<span class="org-whitespace-space"> </span><span class="org-variable-name">count</span>=3<span class="org-whitespace-space"> </span><span class="org-variable-name">bs</span>=1
</pre>
</div>
<p>
上述指令清零Windows NT兼容幻数，以及硬盘第一基本分区、第二基本分区的起始和结束CHS
地址。如果你使用多系统（Windows/Linux/Etc.）请谨慎运行。
</p>
</div>
</div>

<script src="https://utteranc.es/client.js"
        repo="yygcode/yygcode.github.io"
        issue-term="pathname"
        label=" Utterances"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>
<noscript>Please enable JavaScript to view the <a href="https://github.com/utterance">comments powered by utterances.</a></noscript>
</div>
<div id="postamble" class="status">
<div class="copyright">
2012-2020 Copyright&copy; <i> YANYG<br/>Powered by Emacs Orgmode</i>
</div>
</div>
</body>
</html>
