<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="zh-CN" xml:lang="zh-CN">
<head>
<meta charset="utf-8" />
<title>Linux segfault meaning</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="yanyg" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" href="/themes/blogs/css/blog.css" />
<script type="text/javascript" src="/themes/blogs/js/blog.js"> </script>
</head>
<body>
<div id="preamble" class="status">
<a href="../../../index.html">Yanyg - Software Engineer</a>
<div class="sitelinks">
  <a href="../../archives.html">Archives</a> |
  <a href="../../theindex.html">Index</a> |
  <a href="../../tags.html">TAGS</a> |
  <a href="https://github.com/yygcode">Github</a> |
  <a href="../../../about.html">About Me</a>
</div>
</div>
<div id="content">
<h1 class="title">Linux segfault meaning</h1>
<div class="org-src-container">
<pre class="src src-text">yanyg@t430:~/platform/build$<span class="org-whitespace-space"> </span>sudo<span class="org-whitespace-space"> </span>cat<span class="org-whitespace-space"> </span>/var/log/messages<span class="org-whitespace-space"> </span>|<span class="org-whitespace-space"> </span>grep<span class="org-whitespace-space"> </span>segfault
Mar<span class="org-whitespace-space">  </span>3<span class="org-whitespace-space"> </span>22:35:23<span class="org-whitespace-space"> </span>t430<span class="org-whitespace-space"> </span>kernel:<span class="org-whitespace-space"> </span>[259968.485176]<span class="org-whitespace-space"> </span>test_memory[25547]:<span class="org-whitespace-space"> </span>segfault<span class="org-whitespace-space"> </span>at<span class="org-whitespace-space"> </span>0<span class="org-whitespace-space"> </span>i<span class="org-whitespace-line">p</span><span class="org-whitespace-space"><span class="org-whitespace-line"> </span></span><span class="org-whitespace-line">0000561ca344c481</span><span class="org-whitespace-space"><span class="org-whitespace-line"> </span></span><span class="org-whitespace-line">sp</span><span class="org-whitespace-space"><span class="org-whitespace-line"> </span></span><span class="org-whitespace-line">00007fff51370480</span><span class="org-whitespace-space"><span class="org-whitespace-line"> </span></span><span class="org-whitespace-line">error</span><span class="org-whitespace-space"><span class="org-whitespace-line"> </span></span><span class="org-whitespace-line">6</span><span class="org-whitespace-space"><span class="org-whitespace-line"> </span></span><span class="org-whitespace-line">in</span><span class="org-whitespace-space"><span class="org-whitespace-line"> </span></span><span class="org-whitespace-line">test_memory[561ca343e000+3e000]</span>
Mar<span class="org-whitespace-space">  </span>3<span class="org-whitespace-space"> </span>22:36:01<span class="org-whitespace-space"> </span>t430<span class="org-whitespace-space"> </span>kernel:<span class="org-whitespace-space"> </span>[260006.883227]<span class="org-whitespace-space"> </span>test_memory[27588]:<span class="org-whitespace-space"> </span>segfault<span class="org-whitespace-space"> </span>at<span class="org-whitespace-space"> </span>0<span class="org-whitespace-space"> </span>i<span class="org-whitespace-line">p</span><span class="org-whitespace-space"><span class="org-whitespace-line"> </span></span><span class="org-whitespace-line">000055937db1f496</span><span class="org-whitespace-space"><span class="org-whitespace-line"> </span></span><span class="org-whitespace-line">sp</span><span class="org-whitespace-space"><span class="org-whitespace-line"> </span></span><span class="org-whitespace-line">00007ffd3ecafef0</span><span class="org-whitespace-space"><span class="org-whitespace-line"> </span></span><span class="org-whitespace-line">error</span><span class="org-whitespace-space"><span class="org-whitespace-line"> </span></span><span class="org-whitespace-line">6</span><span class="org-whitespace-space"><span class="org-whitespace-line"> </span></span><span class="org-whitespace-line">in</span><span class="org-whitespace-space"><span class="org-whitespace-line"> </span></span><span class="org-whitespace-line">test_memory[55937db11000+3e000]</span>
Mar<span class="org-whitespace-space">  </span>3<span class="org-whitespace-space"> </span>22:36:12<span class="org-whitespace-space"> </span>t430<span class="org-whitespace-space"> </span>kernel:<span class="org-whitespace-space"> </span>[260017.962634]<span class="org-whitespace-space"> </span>test_memory[28159]:<span class="org-whitespace-space"> </span>segfault<span class="org-whitespace-space"> </span>at<span class="org-whitespace-space"> </span>0<span class="org-whitespace-space"> </span>i<span class="org-whitespace-line">p</span><span class="org-whitespace-space"><span class="org-whitespace-line"> </span></span><span class="org-whitespace-line">000055c8ac8c4496</span><span class="org-whitespace-space"><span class="org-whitespace-line"> </span></span><span class="org-whitespace-line">sp</span><span class="org-whitespace-space"><span class="org-whitespace-line"> </span></span><span class="org-whitespace-line">00007ffec8b966b0</span><span class="org-whitespace-space"><span class="org-whitespace-line"> </span></span><span class="org-whitespace-line">error</span><span class="org-whitespace-space"><span class="org-whitespace-line"> </span></span><span class="org-whitespace-line">6</span><span class="org-whitespace-space"><span class="org-whitespace-line"> </span></span><span class="org-whitespace-line">in</span><span class="org-whitespace-space"><span class="org-whitespace-line"> </span></span><span class="org-whitespace-line">test_memory[55c8ac8b6000+3e000]</span>
Mar<span class="org-whitespace-space">  </span>3<span class="org-whitespace-space"> </span>22:38:37<span class="org-whitespace-space"> </span>t430<span class="org-whitespace-space"> </span>kernel:<span class="org-whitespace-space"> </span>[260162.515243]<span class="org-whitespace-space"> </span>test_memory[1919]:<span class="org-whitespace-space"> </span>segfault<span class="org-whitespace-space"> </span>at<span class="org-whitespace-space"> </span>0<span class="org-whitespace-space"> </span>ip<span class="org-whitespace-space"><span class="org-whitespace-line"> </span></span><span class="org-whitespace-line">0000561b33b8b496</span><span class="org-whitespace-space"><span class="org-whitespace-line"> </span></span><span class="org-whitespace-line">sp</span><span class="org-whitespace-space"><span class="org-whitespace-line"> </span></span><span class="org-whitespace-line">00007fffdb075e90</span><span class="org-whitespace-space"><span class="org-whitespace-line"> </span></span><span class="org-whitespace-line">error</span><span class="org-whitespace-space"><span class="org-whitespace-line"> </span></span><span class="org-whitespace-line">4</span><span class="org-whitespace-space"><span class="org-whitespace-line"> </span></span><span class="org-whitespace-line">in</span><span class="org-whitespace-space"><span class="org-whitespace-line"> </span></span><span class="org-whitespace-line">test_memory[561b33b7d000+3e000]</span>
Mar<span class="org-whitespace-space">  </span>3<span class="org-whitespace-space"> </span>22:43:01<span class="org-whitespace-space"> </span>t430<span class="org-whitespace-space"> </span>kernel:<span class="org-whitespace-space"> </span>[260426.348912]<span class="org-whitespace-space"> </span>test_memory[13029]:<span class="org-whitespace-space"> </span>segfault<span class="org-whitespace-space"> </span>at<span class="org-whitespace-space"> </span>0<span class="org-whitespace-space"> </span>i<span class="org-whitespace-line">p</span><span class="org-whitespace-space"><span class="org-whitespace-line"> </span></span><span class="org-whitespace-line">0000564c5bc9f486</span><span class="org-whitespace-space"><span class="org-whitespace-line"> </span></span><span class="org-whitespace-line">sp</span><span class="org-whitespace-space"><span class="org-whitespace-line"> </span></span><span class="org-whitespace-line">00007ffe05d4e3b0</span><span class="org-whitespace-space"><span class="org-whitespace-line"> </span></span><span class="org-whitespace-line">error</span><span class="org-whitespace-space"><span class="org-whitespace-line"> </span></span><span class="org-whitespace-line">4</span><span class="org-whitespace-space"><span class="org-whitespace-line"> </span></span><span class="org-whitespace-line">in</span><span class="org-whitespace-space"><span class="org-whitespace-line"> </span></span><span class="org-whitespace-line">test_memory[564c5bc91000+3e000]</span>
Mar<span class="org-whitespace-space">  </span>3<span class="org-whitespace-space"> </span>22:45:51<span class="org-whitespace-space"> </span>t430<span class="org-whitespace-space"> </span>kernel:<span class="org-whitespace-space"> </span>[260596.608846]<span class="org-whitespace-space"> </span>test_memory[21028]:<span class="org-whitespace-space"> </span>segfault<span class="org-whitespace-space"> </span>at<span class="org-whitespace-space"> </span>0<span class="org-whitespace-space"> </span>i<span class="org-whitespace-line">p</span><span class="org-whitespace-space"><span class="org-whitespace-line"> </span></span><span class="org-whitespace-line">000056186403d4db</span><span class="org-whitespace-space"><span class="org-whitespace-line"> </span></span><span class="org-whitespace-line">sp</span><span class="org-whitespace-space"><span class="org-whitespace-line"> </span></span><span class="org-whitespace-line">00007fff77c5fb50</span><span class="org-whitespace-space"><span class="org-whitespace-line"> </span></span><span class="org-whitespace-line">error</span><span class="org-whitespace-space"><span class="org-whitespace-line"> </span></span><span class="org-whitespace-line">6</span><span class="org-whitespace-space"><span class="org-whitespace-line"> </span></span><span class="org-whitespace-line">in</span><span class="org-whitespace-space"><span class="org-whitespace-line"> </span></span><span class="org-whitespace-line">test_memory[56186402f000+3e000]</span>
Mar<span class="org-whitespace-space">  </span>3<span class="org-whitespace-space"> </span>22:48:37<span class="org-whitespace-space"> </span>t430<span class="org-whitespace-space"> </span>kernel:<span class="org-whitespace-space"> </span>[260762.502445]<span class="org-whitespace-space"> </span>test_memory[26497]:<span class="org-whitespace-space"> </span>segfault<span class="org-whitespace-space"> </span>at<span class="org-whitespace-space"> </span>0<span class="org-whitespace-space"> </span>i<span class="org-whitespace-line">p</span><span class="org-whitespace-space"><span class="org-whitespace-line"> </span></span><span class="org-whitespace-line">0000560b14cc84db</span><span class="org-whitespace-space"><span class="org-whitespace-line"> </span></span><span class="org-whitespace-line">sp</span><span class="org-whitespace-space"><span class="org-whitespace-line"> </span></span><span class="org-whitespace-line">00007fffbd248ef0</span><span class="org-whitespace-space"><span class="org-whitespace-line"> </span></span><span class="org-whitespace-line">error</span><span class="org-whitespace-space"><span class="org-whitespace-line"> </span></span><span class="org-whitespace-line">6</span><span class="org-whitespace-space"><span class="org-whitespace-line"> </span></span><span class="org-whitespace-line">in</span><span class="org-whitespace-space"><span class="org-whitespace-line"> </span></span><span class="org-whitespace-line">test_memory[560b14cba000+3e000]</span>
</pre>
</div>

<ul class="org-ul">
<li>test_memory[26497]: 进程binary名称和ID；</li>
<li>at 0: 尝试访问无效地址0；</li>
<li>ip 0000560b14cc84db: 正在执行的指令(rip)；</li>
<li>sp 00007fffbd248ef0: 当前堆栈指针(rsp)；</li>
<li>error: 4 用户态读，6用户态写</li>
</ul>
<div class="org-src-container">
<pre class="src src-C"><span class="org-comment-delimiter">/*</span>
<span class="org-whitespace-space"> </span><span class="org-comment">*</span><span class="org-whitespace-space"> </span><span class="org-comment">Page</span><span class="org-whitespace-space"> </span><span class="org-comment">fault</span><span class="org-whitespace-space"> </span><span class="org-comment">error</span><span class="org-whitespace-space"> </span><span class="org-comment">code</span><span class="org-whitespace-space"> </span><span class="org-comment">bits:</span>
<span class="org-whitespace-space"> </span><span class="org-comment">*</span>
<span class="org-whitespace-space"> </span><span class="org-comment">*</span><span class="org-whitespace-space">   </span><span class="org-comment">bit</span><span class="org-whitespace-space"> </span><span class="org-comment">0</span><span class="org-whitespace-space"> </span><span class="org-comment">==</span><span class="org-whitespace-tab">   </span><span class="org-whitespace-space"> </span><span class="org-comment">0:</span><span class="org-whitespace-space"> </span><span class="org-comment">no</span><span class="org-whitespace-space"> </span><span class="org-comment">page</span><span class="org-whitespace-space"> </span><span class="org-comment">found</span><span class="org-whitespace-tab">       </span><span class="org-comment">1:</span><span class="org-whitespace-space"> </span><span class="org-comment">protection</span><span class="org-whitespace-space"> </span><span class="org-comment">fault</span>
<span class="org-whitespace-space"> </span><span class="org-comment">*</span><span class="org-whitespace-space">   </span><span class="org-comment">bit</span><span class="org-whitespace-space"> </span><span class="org-comment">1</span><span class="org-whitespace-space"> </span><span class="org-comment">==</span><span class="org-whitespace-tab">   </span><span class="org-whitespace-space"> </span><span class="org-comment">0:</span><span class="org-whitespace-space"> </span><span class="org-comment">read</span><span class="org-whitespace-space"> </span><span class="org-comment">access</span><span class="org-whitespace-tab">         </span><span class="org-comment">1:</span><span class="org-whitespace-space"> </span><span class="org-comment">write</span><span class="org-whitespace-space"> </span><span class="org-comment">access</span>
<span class="org-whitespace-space"> </span><span class="org-comment">*</span><span class="org-whitespace-space">   </span><span class="org-comment">bit</span><span class="org-whitespace-space"> </span><span class="org-comment">2</span><span class="org-whitespace-space"> </span><span class="org-comment">==</span><span class="org-whitespace-tab">   </span><span class="org-whitespace-space"> </span><span class="org-comment">0:</span><span class="org-whitespace-space"> </span><span class="org-comment">kernel-mode</span><span class="org-whitespace-space"> </span><span class="org-comment">access</span><span class="org-whitespace-tab">  </span><span class="org-comment">1:</span><span class="org-whitespace-space"> </span><span class="org-comment">user-mode</span><span class="org-whitespace-space"> </span><span class="org-comment">access</span>
<span class="org-whitespace-space"> </span><span class="org-comment">*</span><span class="org-whitespace-space">   </span><span class="org-comment">bit</span><span class="org-whitespace-space"> </span><span class="org-comment">3</span><span class="org-whitespace-space"> </span><span class="org-comment">==</span><span class="org-whitespace-tab">                           </span><span class="org-comment">1:</span><span class="org-whitespace-space"> </span><span class="org-comment">use</span><span class="org-whitespace-space"> </span><span class="org-comment">of</span><span class="org-whitespace-space"> </span><span class="org-comment">reserved</span><span class="org-whitespace-space"> </span><span class="org-comment">bit</span><span class="org-whitespace-space"> </span><span class="org-comment">detected</span>
<span class="org-whitespace-space"> </span><span class="org-comment">*</span><span class="org-whitespace-space">   </span><span class="org-comment">bit</span><span class="org-whitespace-space"> </span><span class="org-comment">4</span><span class="org-whitespace-space"> </span><span class="org-comment">==</span><span class="org-whitespace-tab">                           </span><span class="org-comment">1:</span><span class="org-whitespace-space"> </span><span class="org-comment">fault</span><span class="org-whitespace-space"> </span><span class="org-comment">was</span><span class="org-whitespace-space"> </span><span class="org-comment">an</span><span class="org-whitespace-space"> </span><span class="org-comment">instruction</span><span class="org-whitespace-space"> </span><span class="org-comment">fetch</span>
<span class="org-whitespace-space"> </span><span class="org-comment">*</span><span class="org-whitespace-space">   </span><span class="org-comment">bit</span><span class="org-whitespace-space"> </span><span class="org-comment">5</span><span class="org-whitespace-space"> </span><span class="org-comment">==</span><span class="org-whitespace-tab">                           </span><span class="org-comment">1:</span><span class="org-whitespace-space"> </span><span class="org-comment">protection</span><span class="org-whitespace-space"> </span><span class="org-comment">keys</span><span class="org-whitespace-space"> </span><span class="org-comment">block</span><span class="org-whitespace-space"> </span><span class="org-comment">access</span>
<span class="org-whitespace-space"> </span><span class="org-comment-delimiter">*/</span>
<span class="org-keyword">enum</span><span class="org-whitespace-space"> </span><span class="org-type">x86_pf_error_code</span><span class="org-whitespace-space"> </span>{
<span class="org-whitespace-space">        </span><span class="org-variable-name">X86_PF_PROT</span><span class="org-whitespace-tab">     </span>=<span class="org-whitespace-tab">               </span>1<span class="org-whitespace-space"> </span>&lt;&lt;<span class="org-whitespace-space"> </span>0,
<span class="org-whitespace-space">        </span><span class="org-variable-name">X86_PF_WRITE</span><span class="org-whitespace-tab">    </span>=<span class="org-whitespace-tab">               </span>1<span class="org-whitespace-space"> </span>&lt;&lt;<span class="org-whitespace-space"> </span>1,
<span class="org-whitespace-space">        </span><span class="org-variable-name">X86_PF_USER</span><span class="org-whitespace-tab">     </span>=<span class="org-whitespace-tab">               </span>1<span class="org-whitespace-space"> </span>&lt;&lt;<span class="org-whitespace-space"> </span>2,
<span class="org-whitespace-space">        </span><span class="org-variable-name">X86_PF_RSVD</span><span class="org-whitespace-tab">     </span>=<span class="org-whitespace-tab">               </span>1<span class="org-whitespace-space"> </span>&lt;&lt;<span class="org-whitespace-space"> </span>3,
<span class="org-whitespace-space">        </span><span class="org-variable-name">X86_PF_INSTR</span><span class="org-whitespace-tab">    </span>=<span class="org-whitespace-tab">               </span>1<span class="org-whitespace-space"> </span>&lt;&lt;<span class="org-whitespace-space"> </span>4,
<span class="org-whitespace-space">        </span><span class="org-variable-name">X86_PF_PK</span><span class="org-whitespace-tab">       </span>=<span class="org-whitespace-tab">               </span>1<span class="org-whitespace-space"> </span>&lt;&lt;<span class="org-whitespace-space"> </span>5,
};
</pre>
</div>
<ul class="org-ul">
<li>in test_memory[560b14cba000+3e000]: 发生问题时ip所在的虚拟地址范围，</li>
</ul>
<p>
560b14cba000是起始地址，3e000是size；
</p>

<script src="https://utteranc.es/client.js"
        repo="yygcode/yygcode.github.io"
        issue-term="pathname"
        label=" Utterances"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>
<noscript>Please enable JavaScript to view the <a href="https://github.com/utterance">comments powered by utterances.</a></noscript>
</div>
<div id="postamble" class="status">
<div class="copyright">
2012-2020 Copyright&copy; <i> YANYG<br/>Powered by Emacs Orgmode</i>
</div>
</div>
</body>
</html>
